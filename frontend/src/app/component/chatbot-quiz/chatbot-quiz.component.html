<nav class="navbar">
  <ul>
    <li><a routerLink="/">  الرئيسية </a></li>
    <li><a routerLink="/about"> شكون احنا؟</a></li>
    <li><a routerLink="/contact">كلمنا</a></li>
  </ul>
</nav>
<app-avatar></app-avatar>
<div class="chat-container" dir="rtl">
  <div class="chat-box">

    <!-- Header -->
    <div class="chat-header">
      <div class="bot-avatar">
        <img src="/assets/images/bot.png" alt="Chatbot Avatar" />
        <div class="status-dot"></div>
      </div>
      <div class="header-text">
        <h2>المساعد الذكي</h2>
        <div class="status">متصل الآن</div>
      </div>
      <div class="header-decoration">
        <span class="star">⭐</span>
        <span class="star">⭐</span>
        <span class="star">⭐</span>
      </div>
      <button class="exit-button" routerLink="/select-mode">
        العودة
      </button>
    </div>

    <!-- Messages -->
    <div class="messages-container">
      <div *ngFor="let message of messages"
           [ngClass]="{
             'message': true,
             'user-message': message.isUser,
             'bot-message': !message.isUser
           }">
        <div class="message-content">
          <div class="message-bubble" [innerHTML]="message.text"></div>
          <div class="message-time">
            {{ message.isUser ? 'أنت' : 'المساعد' }}
          </div>
        </div>
      </div>

      <div *ngIf="isLoading" class="message bot-message">
        <div class="message-content">
          <div class="message-bubble loading-bubble">
            <div class="typing-indicator">
              <span></span><span></span><span></span>
            </div>
          </div>
          <div class="message-time">المساعد</div>
        </div>
      </div>
    </div>

    <!-- Input / Quick Responses -->
    <div class="input-container">

      <!-- 1) After quiz ends: static "كملنا" -->
      <div class="quick-responses" *ngIf="quizFinished">
        <button class="quick-response" disabled>كملنا</button>
      </div>

      <!-- 2) Before quiz starts: "ابدأ الاختبار" -->
      <div class="quick-responses" *ngIf="!inQuiz && !quizFinished">
        <button
          class="quick-response"
          (click)="sendQuickResponse('ابدأ الاختبار')"
          [disabled]="isLoading"
        >
          ابدأ الاختبار
        </button>
      </div>

      <!-- 3) While quiz is active: show options -->
      <div class="quick-responses" *ngIf="inQuiz">
        <button
          *ngFor="let opt of questions[currentQuestionIndex]?.options"
          class="quick-response"
          (click)="answerQuestion(opt)"
          [disabled]="isLoading"
        >
          {{ opt }}
        </button>
      </div>

    </div>
  </div>
</div>